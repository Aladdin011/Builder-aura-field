import{c as l}from"./index-Cy6GCv2B.js";import{u}from"./appStore-D7XBlzzf.js";/**
 * @license lucide-react v0.448.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f=l("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.448.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=l("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.448.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=l("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.448.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=l("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.448.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y=l("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.448.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=l("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.448.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=l("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);class h{sessionId;userId;startTime;events=[];performanceObserver;constructor(){this.sessionId=this.generateSessionId(),this.startTime=new Date,this.initializeTracking()}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}initializeTracking(){this.setupPerformanceMonitoring(),this.setupUserInteractionTracking(),this.setupNavigationTracking(),this.setupErrorTracking(),this.setupConversionTracking()}setupPerformanceMonitoring(){"PerformanceObserver"in window&&(this.performanceObserver=new PerformanceObserver(t=>{t.getEntries().forEach(e=>{this.trackPerformanceMetric(e)})}),this.performanceObserver.observe({entryTypes:["navigation","paint","largest-contentful-paint","first-input","layout-shift"]})),window.addEventListener("load",()=>{this.trackResourcePerformance()})}trackPerformanceMetric(t){const{updatePerformance:e}=u.getState();switch(t.entryType){case"largest-contentful-paint":e({lcp:t.startTime});break;case"first-input":e({fid:t.processingStart-t.startTime});break;case"layout-shift":t.hadRecentInput||e({cls:t.value});break;case"paint":t.name==="first-contentful-paint"&&e({fcp:t.startTime});break}}trackResourcePerformance(){const t=performance.getEntriesByType("navigation")[0],{updatePerformance:e}=u.getState();e({ttfb:t.responseStart-t.fetchStart});const r=performance.getEntriesByType("resource").filter(n=>n.duration>1e3);r.length>0&&this.trackEvent("performance","slow_resources",{count:r.length,resources:r.map(n=>({name:n.name,duration:n.duration}))})}setupUserInteractionTracking(){try{let t=0,e=null;const a=1e3;document.addEventListener("click",s=>{try{const i=Date.now(),d=s.target;if(i-t<a&&e===d)return;this.shouldTrackElement(d)&&(t=i,e=d,this.trackInteraction("click",s))}catch(i){i instanceof Error&&i.message.includes("Cannot read")&&console.warn("Click tracking error:",i.message)}},{passive:!0});let r=0,n=null;document.addEventListener("scroll",()=>{n||(n=setTimeout(()=>{try{const s=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),i=Math.round(window.scrollY/(s-window.innerHeight)*100);i>r&&i%25===0&&i<=100&&(r=i,this.trackEvent("engagement","scroll_depth",{depth:i}))}catch{}n=null},250))},{passive:!0}),document.addEventListener("focus",s=>{try{(s.target.tagName==="INPUT"||s.target.tagName==="TEXTAREA")&&this.trackInteraction("form_focus",s)}catch(i){console.warn("Form interaction tracking error:",i)}},{passive:!0});let c=Date.now();document.addEventListener("beforeunload",()=>{try{const s=Date.now()-c;this.trackEvent("engagement","time_on_page",{duration:s})}catch(s){console.warn("Time tracking error:",s)}})}catch(t){console.warn("Failed to setup user interaction tracking:",t)}}shouldTrackElement(t){if(!t||!t.tagName||["HTML","BODY","DIV","SPAN","SVG","PATH"].includes(t.tagName))return!1;const a=["BUTTON","A","INPUT","SELECT","TEXTAREA"],r=t.onclick||t.getAttribute("data-track")==="true",n=a.includes(t.tagName),c=t.getAttribute("role")==="button"||t.getAttribute("role")==="link",s=t.getAttribute("aria-label");return t.hasAttribute("disabled")||t.getAttribute("aria-disabled")==="true"?!1:n||r||c||s}trackInteraction(t,e){try{const a=e.target;if(!a)return;const r=this.getElementSelector(a);if(!r)return;const n={type:t,element:r,timestamp:new Date,coordinates:t==="click"&&e instanceof MouseEvent?{x:e.clientX||0,y:e.clientY||0}:void 0,value:this.getSafeElementValue(a)};this.trackEvent("interaction",t,n);try{const{trackUserInteraction:c}=u.getState();c&&c(`${t}-${r}`)}catch{}}catch{}}getSafeElementValue(t){try{return t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement?t.value?.slice(0,100)||"":t.textContent?.slice(0,100)||""}catch{return""}}getElementSelector(t){try{if(!t||!t.tagName)return"unknown";if(t.id&&typeof t.id=="string")return`#${t.id}`;if(t.className&&typeof t.className=="string"){const e=t.className.trim().split(" ")[0];if(e)return`.${e}`}return t.getAttribute&&t.getAttribute("data-testid")?`[data-testid="${t.getAttribute("data-testid")}"]`:t.tagName.toLowerCase()}catch{return"unknown"}}setupNavigationTracking(){let t=window.location.pathname;const e=()=>{const n=window.location.pathname;n!==t&&(this.trackEvent("navigation","page_view",{from:t,to:n,timestamp:new Date}),t=n)};window.addEventListener("popstate",e);const a=history.pushState,r=history.replaceState;history.pushState=function(...n){a.apply(history,n),setTimeout(e,0)},history.replaceState=function(...n){r.apply(history,n),setTimeout(e,0)}}setupErrorTracking(){try{window.addEventListener("error",t=>{try{this.trackEvent("error","javascript_error",{message:t.message,filename:t.filename,line:t.lineno,column:t.colno,stack:t.error?.stack,timestamp:new Date})}catch(e){console.warn("Error tracking failed:",e)}},{passive:!0}),window.addEventListener("unhandledrejection",t=>{try{this.trackEvent("error","promise_rejection",{reason:t.reason,timestamp:new Date})}catch(e){console.warn("Promise rejection tracking failed:",e)}},{passive:!0})}catch(t){console.warn("Failed to setup error tracking:",t)}}setupConversionTracking(){["contact-form-submit","phone-click","email-click","project-inquiry","consultation-request","portfolio-download"].forEach(e=>{document.addEventListener(e,a=>{this.trackConversion(e,a.detail)})})}trackConversion(t,e){const a={type:t,timestamp:new Date,sessionId:this.sessionId,userId:this.userId,page:window.location.pathname,referrer:document.referrer,data:e};this.trackEvent("conversion",t,a),this.updateConversionFunnel(t)}updateConversionFunnel(t){const a=["page_view","portfolio_view","service_view","contact_form_view","contact_form_submit"].indexOf(t);a!==-1&&this.trackEvent("funnel","step_completion",{step:t,stepIndex:a,timestamp:new Date})}assignABTestVariant(t,e){const a=localStorage.getItem(`ab_test_${t}`);if(a&&e.includes(a))return a;const r=e[Math.floor(Math.random()*e.length)];return localStorage.setItem(`ab_test_${t}`,r),this.trackEvent("ab_test","variant_assigned",{testName:t,variant:r,timestamp:new Date}),r}trackABTestConversion(t,e,a){this.trackEvent("ab_test","conversion",{testName:t,variant:e,conversionType:a,timestamp:new Date})}collectHeatMapData(t,e){const a=t.getBoundingClientRect(),r={element:this.getElementSelector(t),eventType:e,coordinates:{x:a.left+a.width/2,y:a.top+a.height/2},viewport:{width:window.innerWidth,height:window.innerHeight},timestamp:new Date};this.trackEvent("heatmap",e,r)}trackEvent(t,e,a){try{if(!t||!e)return;const r={category:String(t),action:String(e),data:a||{},timestamp:new Date,sessionId:this.sessionId,userId:this.userId,page:window.location?.pathname||"",userAgent:navigator?.userAgent||""};this.events.length>1e3&&(this.events=this.events.slice(-500)),this.events.push(r),this.sendToAnalytics(r),this.updateAppStore(r)}catch{}}sendToAnalytics(t){try{typeof gtag<"u"&&gtag("event",t.action,{event_category:t.category,event_label:t.data?.element||"",value:t.data?.value||0,custom_parameter_1:t.sessionId})}catch{}}updateAppStore(t){try{const e=u.getState();if(!e||!e.updateAnalytics)return;const{updateAnalytics:a}=e;t.category==="engagement"&&a({lastInteraction:t.timestamp})}catch{}}exportData(t="json"){const e={sessionId:this.sessionId,userId:this.userId,startTime:this.startTime,events:this.events,summary:this.generateSummary()};return t==="csv"?this.convertToCSV(e):JSON.stringify(e,null,2)}generateSummary(){const t=this.events.length,e=this.events.reduce((r,n)=>(r[n.category]=(r[n.category]||0)+1,r),{}),a=Date.now()-this.startTime.getTime();return{totalEvents:t,eventsByCategory:e,sessionDuration:a,pagesViewed:new Set(this.events.filter(r=>r.category==="navigation").map(r=>r.page)).size}}convertToCSV(t){const e=["timestamp","category","action","page","element","value"],a=t.events.map(r=>[r.timestamp.toISOString(),r.category,r.action,r.page,r.data?.element||"",r.data?.value||""]);return[e,...a].map(r=>r.join(",")).join(`
`)}destroy(){this.performanceObserver&&this.performanceObserver.disconnect(),this.trackEvent("session","end",{duration:Date.now()-this.startTime.getTime(),eventCount:this.events.length})}}const o=new h,b=()=>({trackEvent:o.trackEvent.bind(o),trackConversion:o.trackConversion.bind(o),assignABTestVariant:o.assignABTestVariant.bind(o),trackABTestConversion:o.trackABTestConversion.bind(o),collectHeatMapData:o.collectHeatMapData.bind(o),exportData:o.exportData.bind(o)});window.addEventListener("beforeunload",()=>{o.destroy()});export{f as A,k as B,w as C,y as E,E as M,T as S,v as a,b as u};
