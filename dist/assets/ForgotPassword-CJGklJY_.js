import{c as H,a as o,y as J,u as U,j as e,m as l,L as E,A as k}from"./index-D3bZ8EQR.js";import{B as m}from"./button-Dn6WXJOc.js";import{I as w}from"./input-eshf1J7M.js";import{C as A,L as f}from"./label-BdoalC1J.js";import{C as W,a as Z,b as G,c as Q,d as X}from"./card-7ABFXqAC.js";import{u as _,P as ee}from"./useAnalytics-b5TyfALi.js";import{C as y}from"./circle-check-big-geyjb56P.js";import{M as L}from"./mail-9r1LQtgw.js";import{L as N,E as R}from"./loader-circle-70vVQnpT.js";import{A as se}from"./arrow-left-DaFkHxJ9.js";import{L as v}from"./lock-DllgX7BB.js";import{E as F}from"./eye-BWznZfxH.js";/**
 * @license lucide-react v0.448.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=H("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);function ge(){const[c,h]=o.useState("email"),[s,D]=o.useState({email:"",code:"",newPassword:"",confirmPassword:""}),[p,I]=o.useState(!1),[b,V]=o.useState(!1),[i,M]=o.useState(null),[P,t]=o.useState(""),[C,S]=o.useState(""),[n,d]=o.useState(!1),{forgotPassword:q,resetPassword:B}=J(),{trackBusinessEvent:j}=_(),$=U(),u=(a,r)=>{if(D(g=>({...g,[a]:r})),a==="confirmPassword"||a==="newPassword"&&s.confirmPassword){const g=a==="newPassword"?r:s.newPassword,z=a==="confirmPassword"?r:s.confirmPassword;M(g===z&&g.length>0)}},T=a=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a),O=async a=>{if(a.preventDefault(),t(""),!s.email){t("Please enter your email address");return}if(!T(s.email)){t("Please enter a valid email address");return}d(!0);try{const r=await q(s.email);r.success?(S("Password reset code sent to your email"),h("code"),j.userAuth("forgot-password-sent")):t(r.error||"Failed to send reset email")}catch{t("An error occurred. Please try again.")}finally{d(!1)}},K=async a=>{if(a.preventDefault(),t(""),!s.code){t("Please enter the verification code");return}if(s.code.length!==6){t("Verification code must be 6 digits");return}d(!0);try{await new Promise(r=>setTimeout(r,1e3)),s.code.length===6?(S("Code verified successfully"),h("password"),j.userAuth("reset-code-verified")):t("Invalid verification code")}catch{t("Invalid verification code")}finally{d(!1)}},Y=async a=>{if(a.preventDefault(),t(""),!s.newPassword||!s.confirmPassword){t("Please fill in all fields");return}if(s.newPassword.length<8){t("Password must be at least 8 characters long");return}if(!i){t("Passwords do not match");return}d(!0);try{const r=await B(s.email,s.code,s.newPassword);r.success?(h("success"),j.userAuth("password-reset-completed")):t(r.error||"Failed to reset password")}catch{t("An error occurred. Please try again.")}finally{d(!1)}},x={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3}};return e.jsx(ee,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-arch-light-blue/20 via-white to-arch-light-blue/30 flex items-center justify-center p-4",children:e.jsx(l.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"w-full max-w-md",children:e.jsxs(W,{className:"shadow-2xl border-0 overflow-hidden backdrop-blur-sm bg-white/95",children:[e.jsx(Z,{className:"bg-gradient-to-r from-arch-charcoal to-arch-blue-gray text-white py-8",children:e.jsxs(l.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.6,delay:.2},className:"text-center",children:[e.jsx(E,{to:"/",className:"inline-block mb-4 hover:opacity-80 transition-opacity",children:e.jsx("img",{src:"/images/brand/logo.jpg",alt:"JD Marc Limited Logo",className:"h-16 w-auto mx-auto object-contain",onError:a=>{a.currentTarget.src="https://cdn.builder.io/api/v1/image/assets%2F751ea84be0da437c8dd3f1bf04173189%2F6982878bae124d2589b95f89b1a5cf5b?format=webp&width=200"}})}),e.jsx(G,{className:"text-2xl font-bold text-white mb-2",children:"Reset Password"}),e.jsxs(Q,{className:"text-arch-light-blue",children:[c==="email"&&"Enter your email to reset your password",c==="code"&&"Enter the verification code",c==="password"&&"Create a new password",c==="success"&&"Password reset successful"]})]})}),e.jsxs(X,{className:"p-8",children:[e.jsxs(k,{children:[P&&e.jsxs(l.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3",children:[e.jsx(A,{className:"h-5 w-5 text-red-500 flex-shrink-0"}),e.jsx("span",{className:"text-red-700 text-sm",children:P})]}),C&&e.jsxs(l.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-3",children:[e.jsx(y,{className:"h-5 w-5 text-green-500 flex-shrink-0"}),e.jsx("span",{className:"text-green-700 text-sm",children:C})]})]}),e.jsxs(k,{mode:"wait",children:[c==="email"&&e.jsxs(l.form,{...x,onSubmit:O,className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-arch-orange/10 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(L,{className:"h-8 w-8 text-arch-orange"})}),e.jsx("h3",{className:"text-xl font-semibold text-arch-charcoal",children:"Forgot Password?"}),e.jsx("p",{className:"text-arch-blue-gray text-sm mt-1",children:"Enter your email and we'll send you a reset code"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"email",className:"text-arch-charcoal font-medium",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-3 h-5 w-5 text-arch-blue-gray"}),e.jsx(w,{id:"email",type:"email",placeholder:"Enter your email address",className:"pl-11 h-12 border-arch-light-blue/50 focus:border-arch-orange focus:ring-arch-orange/20",value:s.email,onChange:a=>u("email",a.target.value),required:!0})]})]}),e.jsx(m,{type:"submit",disabled:n,className:"w-full h-12 bg-arch-orange hover:bg-arch-rust text-white font-medium",children:n?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"h-4 w-4 animate-spin mr-2"}),"Sending Reset Code..."]}):"Send Reset Code"})]},"email-step"),c==="code"&&e.jsxs(l.form,{...x,onSubmit:K,className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-arch-orange/10 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(ae,{className:"h-8 w-8 text-arch-orange"})}),e.jsx("h3",{className:"text-xl font-semibold text-arch-charcoal",children:"Enter Verification Code"}),e.jsxs("p",{className:"text-arch-blue-gray text-sm mt-1",children:["We've sent a 6-digit code to ",e.jsx("strong",{children:s.email})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"code",className:"text-arch-charcoal font-medium",children:"Verification Code"}),e.jsx(w,{id:"code",placeholder:"Enter 6-digit code",className:"h-12 text-center text-2xl tracking-widest border-arch-light-blue/50 focus:border-arch-orange focus:ring-arch-orange/20",value:s.code,onChange:a=>{const r=a.target.value.replace(/\D/g,"").slice(0,6);u("code",r)},maxLength:6,required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(m,{type:"submit",disabled:n,className:"w-full h-12 bg-arch-orange hover:bg-arch-rust text-white font-medium",children:n?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"h-4 w-4 animate-spin mr-2"}),"Verifying Code..."]}):"Verify Code"}),e.jsxs(m,{type:"button",variant:"outline",onClick:()=>h("email"),className:"w-full border-arch-light-blue text-arch-charcoal hover:bg-arch-light-blue/20",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Back to Email"]})]})]},"code-step"),c==="password"&&e.jsxs(l.form,{...x,onSubmit:Y,className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-arch-orange/10 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(v,{className:"h-8 w-8 text-arch-orange"})}),e.jsx("h3",{className:"text-xl font-semibold text-arch-charcoal",children:"Create New Password"}),e.jsx("p",{className:"text-arch-blue-gray text-sm mt-1",children:"Choose a strong password for your account"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"newPassword",className:"text-arch-charcoal font-medium",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{className:"absolute left-3 top-3 h-5 w-5 text-arch-blue-gray"}),e.jsx(w,{id:"newPassword",type:p?"text":"password",placeholder:"Enter new password",className:"pl-11 pr-11 h-12 border-arch-light-blue/50 focus:border-arch-orange focus:ring-arch-orange/20",value:s.newPassword,onChange:a=>u("newPassword",a.target.value),required:!0}),e.jsx("button",{type:"button",onClick:()=>I(!p),className:"absolute right-3 top-3 text-arch-blue-gray hover:text-arch-orange transition-colors",children:p?e.jsx(R,{className:"h-5 w-5"}):e.jsx(F,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"confirmPassword",className:"text-arch-charcoal font-medium",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{className:"absolute left-3 top-3 h-5 w-5 text-arch-blue-gray"}),e.jsx(w,{id:"confirmPassword",type:b?"text":"password",placeholder:"Confirm new password",className:`pl-11 pr-16 h-12 border-arch-light-blue/50 focus:border-arch-orange focus:ring-arch-orange/20 ${i===!1?"border-red-500 focus:border-red-500":i===!0?"border-green-500 focus:border-green-500":""}`,value:s.confirmPassword,onChange:a=>u("confirmPassword",a.target.value),required:!0}),e.jsxs("div",{className:"absolute right-11 top-3",children:[i===!0&&e.jsx(y,{className:"h-5 w-5 text-green-500"}),i===!1&&e.jsx(A,{className:"h-5 w-5 text-red-500"})]}),e.jsx("button",{type:"button",onClick:()=>V(!b),className:"absolute right-3 top-3 text-arch-blue-gray hover:text-arch-orange transition-colors",children:b?e.jsx(R,{className:"h-5 w-5"}):e.jsx(F,{className:"h-5 w-5"})})]}),i===!1&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:"Passwords do not match"})]})]}),e.jsxs("div",{className:"bg-arch-light-blue/20 border border-arch-light-blue/40 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-arch-charcoal mb-2",children:"Password Requirements:"}),e.jsxs("ul",{className:"text-sm text-arch-blue-gray space-y-1",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${s.newPassword.length>=8?"bg-green-500":"bg-gray-300"}`}),"At least 8 characters long"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${/[A-Z]/.test(s.newPassword)?"bg-green-500":"bg-gray-300"}`}),"One uppercase letter"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${/[0-9]/.test(s.newPassword)?"bg-green-500":"bg-gray-300"}`}),"One number"]})]})]}),e.jsx(m,{type:"submit",disabled:n,className:"w-full h-12 bg-arch-orange hover:bg-arch-rust text-white font-medium",children:n?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"h-4 w-4 animate-spin mr-2"}),"Resetting Password..."]}):"Reset Password"})]},"password-step"),c==="success"&&e.jsxs(l.div,{...x,className:"text-center space-y-6",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(y,{className:"h-8 w-8 text-green-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-arch-charcoal mb-2",children:"Password Reset Successful!"}),e.jsx("p",{className:"text-arch-blue-gray",children:"Your password has been successfully reset. You can now log in with your new password."})]}),e.jsx(m,{onClick:()=>$("/login"),className:"w-full h-12 bg-arch-orange hover:bg-arch-rust text-white font-medium",children:"Continue to Login"})]},"success-step")]}),c!=="success"&&e.jsx("div",{className:"text-center mt-8 pt-6 border-t border-arch-light-blue/30",children:e.jsxs("p",{className:"text-arch-blue-gray",children:["Remember your password?"," ",e.jsx(E,{to:"/login",className:"text-arch-orange hover:text-arch-rust font-medium transition-colors",children:"Sign in here"})]})})]})]})})})})}export{ge as default};
